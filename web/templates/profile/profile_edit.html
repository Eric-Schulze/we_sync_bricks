{{define "profile-edit-content"}}
<div class="space-y-6">
    <!-- Page Header -->
    <div class="flex items-center justify-between">
        <div>
            <h1 class="page-heading">
                Edit Profile
            </h1>
            <p class="mt-1 text-sm text-gray-500">
                Update your account information and API settings
            </p>
        </div>
        <div class="flex items-center space-x-3">
            <button type="button" 
                    class="inline-flex items-center rounded-md bg-gray-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600"
                    hx-get="/profile" 
                    hx-target="#profile-content" 
                    hx-push-url="true">
                <svg class="-ml-0.5 mr-1.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M7.793 2.232a.75.75 0 01-.025 1.06L3.622 7.25h10.003a5.375 5.375 0 010 10.75H10.75a.75.75 0 010-1.5h2.875a3.875 3.875 0 000-7.75H3.622l4.146 3.957a.75.75 0 01-1.036 1.085l-5.5-5.25a.75.75 0 010-1.085l5.5-5.25a.75.75 0 011.06.025z" clip-rule="evenodd" />
                </svg>
                Back to Profile
            </button>
        </div>
    </div>

    <!-- Basic Profile Information -->
    <div class="bg-white shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Basic Information</h3>
            
            <form hx-post="/profile/edit" hx-target="#profile-content" hx-push-url="true" class="space-y-4">
                <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                    <div>
                        <label for="first_name" class="block text-sm font-medium text-gray-700">First Name</label>
                        <input type="text" 
                               name="first_name" 
                               id="first_name" 
                               value="{{.User.FirstName}}"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="last_name" class="block text-sm font-medium text-gray-700">Last Name</label>
                        <input type="text" 
                               name="last_name" 
                               id="last_name" 
                               value="{{.User.LastName}}"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="username" class="block text-sm font-medium text-gray-700">Username</label>
                        <input type="text" 
                               name="username" 
                               id="username" 
                               value="{{.User.Username}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" 
                               name="email" 
                               id="email" 
                               value="{{.User.Email}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>
                </div>

                <div class="flex justify-end">
                    <button type="submit" 
                            class="inline-flex items-center rounded-md bg-lego-blue px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-lego-blue">
                        <svg class="-ml-0.5 mr-1.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                        </svg>
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Password Change -->
    <div class="bg-white shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Change Password</h3>
            
            <div id="password-result" class="mb-4"></div>
            
            <form hx-post="/profile/change-password" hx-target="#password-result" class="space-y-4">
                <div>
                    <label for="current_password" class="block text-sm font-medium text-gray-700">Current Password</label>
                    <input type="password" 
                           name="current_password" 
                           id="current_password" 
                           required
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                </div>

                <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                    <div>
                        <label for="new_password" class="block text-sm font-medium text-gray-700">New Password</label>
                        <input type="password" 
                               name="new_password" 
                               id="new_password" 
                               required
                               minlength="8"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                        <p class="mt-1 text-xs text-gray-500">Must be at least 8 characters long</p>
                    </div>

                    <div>
                        <label for="confirm_password" class="block text-sm font-medium text-gray-700">Confirm New Password</label>
                        <input type="password" 
                               name="confirm_password" 
                               id="confirm_password" 
                               required
                               minlength="8"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>
                </div>

                <div class="flex justify-end">
                    <button type="submit" 
                            class="inline-flex items-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600">
                        <svg class="-ml-0.5 mr-1.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 7a3 3 0 016 0v2.5A1.5 1.5 0 0112.5 11h-5A1.5 1.5 0 016 9.5V7zm8 0v2.5a1.5 1.5 0 001.5 1.5h.5a.5.5 0 00.5-.5V7a5 5 0 00-10 0v3.5A1.5 1.5 0 005.5 12h9a1.5 1.5 0 001.5-1.5V7z" clip-rule="evenodd" />
                        </svg>
                        Change Password
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bricklink API Configuration -->
    <div class="bg-white shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h3 class="text-lg leading-6 font-medium text-gray-900">Bricklink API Configuration</h3>
                    <p class="mt-1 text-sm text-gray-500">Configure your Bricklink API credentials for synchronization</p>
                </div>
                {{if .Profile.BricklinkCredentials}}
                <span class="inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800">
                    <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-green-400" fill="currentColor" viewBox="0 0 8 8">
                        <circle cx="4" cy="4" r="3"/>
                    </svg>
                    Configured
                </span>
                {{else}}
                <span class="inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800">
                    <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-red-400" fill="currentColor" viewBox="0 0 8 8">
                        <circle cx="4" cy="4" r="3"/>
                    </svg>
                    Not Configured
                </span>
                {{end}}
            </div>
            
            <div id="bricklink-result" class="mb-4"></div>
            
            <form hx-post="/profile/api-keys" hx-target="#bricklink-result" class="space-y-4">
                <input type="hidden" name="provider" value="bricklink">
                
                <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                    <div>
                        <label for="bricklink_consumer_key" class="block text-sm font-medium text-gray-700">Consumer Key</label>
                        <input type="text" 
                               name="consumer_key" 
                               id="bricklink_consumer_key" 
                               value="{{if .Profile.BricklinkCredentials}}{{.Profile.BricklinkCredentials.ConsumerKey}}{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="bricklink_consumer_secret" class="block text-sm font-medium text-gray-700">Consumer Secret</label>
                        <input type="password" 
                               name="consumer_secret" 
                               id="bricklink_consumer_secret" 
                               placeholder="{{if .Profile.BricklinkCredentials}}••••••••••••••••{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="bricklink_token" class="block text-sm font-medium text-gray-700">Token</label>
                        <input type="text" 
                               name="token" 
                               id="bricklink_token" 
                               value="{{if .Profile.BricklinkCredentials}}{{.Profile.BricklinkCredentials.Token}}{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="bricklink_token_secret" class="block text-sm font-medium text-gray-700">Token Secret</label>
                        <input type="password" 
                               name="token_secret" 
                               id="bricklink_token_secret" 
                               placeholder="{{if .Profile.BricklinkCredentials}}••••••••••••••••{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>
                </div>

                <div class="flex justify-between">
                    {{if .Profile.BricklinkCredentials}}
                    <button type="button" 
                            hx-delete="/profile/api-keys" 
                            hx-vals='{"provider": "bricklink"}'
                            hx-target="#bricklink-result"
                            hx-confirm="Are you sure you want to delete your Bricklink API credentials?"
                            class="inline-flex items-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600">
                        <svg class="-ml-0.5 mr-1.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z" clip-rule="evenodd" />
                        </svg>
                        Delete Credentials
                    </button>
                    {{else}}
                    <div></div>
                    {{end}}
                    
                    <button type="submit" 
                            class="inline-flex items-center rounded-md bg-lego-blue px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-lego-blue">
                        <svg class="-ml-0.5 mr-1.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                        </svg>
                        {{if .Profile.BricklinkCredentials}}Update{{else}}Save{{end}} Bricklink API
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- BrickOwl API Configuration -->
    <div class="bg-white shadow rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h3 class="text-lg leading-6 font-medium text-gray-900">BrickOwl API Configuration</h3>
                    <p class="mt-1 text-sm text-gray-500">Configure your BrickOwl API credentials for synchronization</p>
                </div>
                {{if .Profile.BrickowlCredentials}}
                <span class="inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800">
                    <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-green-400" fill="currentColor" viewBox="0 0 8 8">
                        <circle cx="4" cy="4" r="3"/>
                    </svg>
                    Configured
                </span>
                {{else}}
                <span class="inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800">
                    <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-red-400" fill="currentColor" viewBox="0 0 8 8">
                        <circle cx="4" cy="4" r="3"/>
                    </svg>
                    Not Configured
                </span>
                {{end}}
            </div>
            
            <div id="brickowl-result" class="mb-4"></div>
            
            <form hx-post="/profile/api-keys" hx-target="#brickowl-result" class="space-y-4">
                <input type="hidden" name="provider" value="brickowl">
                
                <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                    <div>
                        <label for="brickowl_consumer_key" class="block text-sm font-medium text-gray-700">Consumer Key</label>
                        <input type="text" 
                               name="consumer_key" 
                               id="brickowl_consumer_key" 
                               value="{{if .Profile.BrickowlCredentials}}{{.Profile.BrickowlCredentials.ConsumerKey}}{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="brickowl_consumer_secret" class="block text-sm font-medium text-gray-700">Consumer Secret</label>
                        <input type="password" 
                               name="consumer_secret" 
                               id="brickowl_consumer_secret" 
                               placeholder="{{if .Profile.BrickowlCredentials}}••••••••••••••••{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="brickowl_token" class="block text-sm font-medium text-gray-700">Token</label>
                        <input type="text" 
                               name="token" 
                               id="brickowl_token" 
                               value="{{if .Profile.BrickowlCredentials}}{{.Profile.BrickowlCredentials.Token}}{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>

                    <div>
                        <label for="brickowl_token_secret" class="block text-sm font-medium text-gray-700">Token Secret</label>
                        <input type="password" 
                               name="token_secret" 
                               id="brickowl_token_secret" 
                               placeholder="{{if .Profile.BrickowlCredentials}}••••••••••••••••{{end}}"
                               required
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lego-blue focus:ring-lego-blue sm:text-sm">
                    </div>
                </div>

                <div class="flex justify-between">
                    {{if .Profile.BrickowlCredentials}}
                    <button type="button" 
                            hx-delete="/profile/api-keys" 
                            hx-vals='{"provider": "brickowl"}'
                            hx-target="#brickowl-result"
                            hx-confirm="Are you sure you want to delete your BrickOwl API credentials?"
                            class="inline-flex items-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600">
                        <svg class="-ml-0.5 mr-1.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z" clip-rule="evenodd" />
                        </svg>
                        Delete Credentials
                    </button>
                    {{else}}
                    <div></div>
                    {{end}}
                    
                    <button type="submit" 
                            class="inline-flex items-center rounded-md bg-lego-green px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-lego-green">
                        <svg class="-ml-0.5 mr-1.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                        </svg>
                        {{if .Profile.BrickowlCredentials}}Update{{else}}Save{{end}} BrickOwl API
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{{end}}