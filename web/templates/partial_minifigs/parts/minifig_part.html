{{define "minifig-part"}}
{{$showSelection := .ShowSelection | default true}}
{{$showPricing := .ShowPricing | default true}}
{{$showImage := .ShowImage | default true}}
{{$showHover := .ShowHover | default true}}
{{$partId := .PartId | default .ID}}
<div class="modal-part-card group relative flex items-center p-3 border border-gray-200 rounded-lg {{if $showHover}}cursor-pointer transition-all duration-200 bg-white hover:bg-blue-50 hover:border-blue-400 hover:shadow-md hover:scale-[1.02]{{else}}bg-gray-50{{end}}"
     {{if $partId}}id="{{$partId}}-card"{{end}}
     {{if .ItemId}}data-item-id="{{.ItemId}}"{{end}}
     {{if .PartNo}}data-part-no="{{.PartNo}}"{{end}}
     {{if .PartName}}data-part-name="{{.PartName}}"{{end}}
     {{if .Quantity}}data-quantity="{{.Quantity}}"{{end}}
     {{if .ColorId}}data-color-id="{{.ColorId}}"{{end}}
     {{if .ItemType}}data-item-type="{{.ItemType}}"{{end}}
     {{if and $showSelection $partId}}onclick="toggleModalPartCard('{{$partId}}')"{{end}}>
    
    <!-- Part details (name and pricing side by side) -->
    <div class="flex-1 min-w-0 mr-3">
        <div class="flex items-start justify-between">
            <!-- Left side: Name and ID -->
            <div class="flex-1 min-w-0 mr-2">
                <div class="font-medium text-gray-800 text-sm truncate">{{.PartName}}</div>
                {{if .PartNo}}<div class="text-xs text-gray-500 truncate">ID: {{.PartNo}}</div>{{end}}
                <div class="mt-1">{{template "color-display" .}}</div>
            </div>
            
            <!-- Right side: Pricing -->
            {{if $showPricing}}
            <div class="text-right text-xs flex-shrink-0">
                <div class="text-gray-600">
                    <div class="mb-1">New: <span id="{{$partId}}-price-new" class="font-semibold text-green-600">Loading...</span></div>
                    <div>Used: <span id="{{$partId}}-price-used" class="font-semibold text-blue-600">Loading...</span></div>
                </div>
            </div>
            {{end}}
        </div>
    </div>
    
    <!-- Part image -->
    {{if $showImage}}
    <div class="flex-none w-12 h-12 mr-3 relative">
        <div id="{{$partId}}-image" class="w-12 h-12 bg-gray-100 border border-gray-200 rounded-md flex items-center justify-center shadow-sm">
            <div class="text-gray-400 text-sm">ðŸ“¦</div>
        </div>
    </div>
    {{end}}
    
    <!-- Quantity and selection -->
    <div class="flex flex-col items-center flex-shrink-0">
        {{if .Quantity}}<div class="text-xs font-semibold text-gray-700 mb-1">Qty: {{.Quantity}}</div>{{end}}
        {{if .QuantityNeeded}}<div class="text-xs font-semibold text-gray-700 mb-1">{{.QuantityCollected}}/{{.QuantityNeeded}}</div>{{end}}
        {{if $showSelection}}
        <div class="modal-selection-indicator w-6 h-6 border-2 border-gray-400 rounded-md flex items-center justify-center transition-all duration-200 bg-white">
            <div class="modal-checkmark hidden text-white text-xs font-bold">âœ“</div>
        </div>
        {{end}}
    </div>
    
    <!-- Hover indicator -->
    {{if $showHover}}
    <div class="absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
        <div class="w-1 h-1 bg-blue-400 rounded-full"></div>
    </div>
    {{end}}
</div>
{{end}}